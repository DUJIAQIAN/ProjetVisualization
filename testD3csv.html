<!DOCTYPE html>
<meta charset="utf-8">



<head>
        <meta charset=" UTF-8 ">
        <title> index1 </title>
        <script src="./lib/d3.js/d3.min.js"></script>
        <script src="./lib/PapaParse-4.6.0/papaparse.min.js"></script>
</head>


<body>

    <script>

        d3.csv("data_v4.csv").then(function(data) {
            var nest = d3.nest()
                .key(function(d) { return d["Date"]; }).sortKeys(d3.ascending)
                .entries(data);
            
            
            var nbElement = []; 

            for (i=0; i<nest.length; i++ ) {
                nbElement.push ({date : nest[i].key, nbObj :  nest[i].values.length});
            }

            console.log(nbElement);
            


            // 2. Use the margin convention practice 
            var margin = {top: 50, right: 50, bottom: 50, left: 50}
                , width = window.innerWidth - margin.left - margin.right // Use the window's width 
                , height = window.innerHeight - margin.top - margin.bottom; // Use the window's height
            
            var svg = d3.select("body").append("svg")
                    .attr("width", width + margin.left + margin.right)
                    .attr("height", height + margin.top + margin.bottom)
                    .append("g")
                    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");


            var xArea = d3.scaleBand()
                .range([0, 800])
                .padding(0.1);
            var yArea = d3.scaleLinear()
                .range([100, 0]);


            xArea.domain(nbElement.map(function(d, i) { return d.date; }));
            yArea.domain(d3.extent(data, function(d) { return d.nbObj; }));


            var areaStart = d3.area()
                .x(function(d) { return xArea(d.date); })
                .y0(100)
                .y1(function(d) { return 100; });
            var area = d3.area()
                .x(function(d) { return xArea(d.date); })
                .y0(100)
                .y1(function(d) { return yArea(d.nbObj); });


            var areaPath = svg.append("path")
                .datum(data)
                .attr("class", "area")
                .attr("transform", "translate(150, 0)")
                .attr("d", areaStart)
                .transition()
                    .duration(2000)
                    .attr("d", area);
        });

        






    </script>
</body> 